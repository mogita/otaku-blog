<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>PHP on mogita</title>
    <link>http://localhost:1313/tags/php.html</link>
    <description>Recent content in PHP on mogita</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-US</language>
    <lastBuildDate>Mon, 18 Jan 2016 23:03:17 +0000</lastBuildDate><atom:link href="http://localhost:1313/tags/php/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>多个域名访问同一个 CodeIgniter 的不同 Controllers</title>
      <link>http://localhost:1313/posts/codeigniter-map-controllers-to-multiple-domains.html</link>
      <pubDate>Mon, 18 Jan 2016 23:03:17 +0000</pubDate>
      
      <guid>http://localhost:1313/posts/codeigniter-map-controllers-to-multiple-domains.html</guid>
      <description>&lt;p&gt;一套 CodeIgniter 部署，可以承载不同的业务：不同的 MVC 模块，用不同的域名访问。严格来讲，要让一个模块独立形成一套 MVC，需使用 wiredesignz 的 &lt;a href=&#34;https://bitbucket.org/wiredesignz/codeigniter-modular-extensions-hmvc&#34;&gt;codeigniter-modular-extensions-hmvc&lt;/a&gt; 扩展。后者则是 CI 自身的路由所提供的特性。&lt;/p&gt;
&lt;p&gt;关于 HMVC 的讲解之后有时间再写。本文只讲如何用不同域名访问不同的 Controllers。&lt;/p&gt;
&lt;h2 id=&#34;配置-nginx&#34;&gt;
  配置 Nginx
  &lt;a class=&#34;heading-link&#34; href=&#34;#%e9%85%8d%e7%bd%ae-nginx&#34;&gt;
    &lt;i class=&#34;fa fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;
  &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;我的服务器环境基于 Nginx，所以这里贴出我的代码（需修改自定义部分后才可复用）。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-nginx&#34; data-lang=&#34;nginx&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;server&lt;/span&gt; &lt;span style=&#34;color:#eceff4&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;server_name&lt;/span&gt;     &lt;span style=&#34;color:#a3be8c&#34;&gt;user.example.com&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;admin.example.com&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;root&lt;/span&gt;            &lt;span style=&#34;color:#a3be8c&#34;&gt;/path/to/code/base&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;index&lt;/span&gt;           &lt;span style=&#34;color:#a3be8c&#34;&gt;index.php&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;index.html&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;index.htm&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;location&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color:#eceff4&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;try_files&lt;/span&gt; $uri $uri/ &lt;span style=&#34;color:#a3be8c&#34;&gt;/index.php?&lt;/span&gt;$query_string&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#eceff4&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;location&lt;/span&gt; &lt;span style=&#34;color:#eceff4&#34;&gt;~&lt;/span&gt; &lt;span style=&#34;color:#ebcb8b&#34;&gt;\.php($|/)&lt;/span&gt; &lt;span style=&#34;color:#eceff4&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;fastcgi_pass&lt;/span&gt;   127.0.0.1&lt;span style=&#34;color:#eceff4&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#b48ead&#34;&gt;9000&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;fastcgi_index&lt;/span&gt;  &lt;span style=&#34;color:#a3be8c&#34;&gt;index.php&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;fastcgi_split_path_info&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;^(.+\.php)(.*)&lt;/span&gt;$&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;fastcgi_param&lt;/span&gt;   &lt;span style=&#34;color:#a3be8c&#34;&gt;PATH_INFO&lt;/span&gt; $fastcgi_path_info&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;fastcgi_param&lt;/span&gt;  &lt;span style=&#34;color:#a3be8c&#34;&gt;SCRIPT_FILENAME&lt;/span&gt;  $document_root$fastcgi_script_name&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;include&lt;/span&gt;        &lt;span style=&#34;color:#a3be8c&#34;&gt;fastcgi_params&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#eceff4&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;location&lt;/span&gt; &lt;span style=&#34;color:#eceff4&#34;&gt;~&lt;/span&gt; &lt;span style=&#34;color:#ebcb8b&#34;&gt;/\.ht&lt;/span&gt; &lt;span style=&#34;color:#eceff4&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;deny&lt;/span&gt;  &lt;span style=&#34;color:#a3be8c&#34;&gt;all&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#eceff4&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;注意把所有域名放在 &lt;code&gt;server_name&lt;/code&gt; 的同一行，中间用空格分开。&lt;/p&gt;
&lt;p&gt;我们照例使用 &lt;code&gt;try_files&lt;/code&gt; 去除 URL 中的 index.php。&lt;/p&gt;
&lt;h2 id=&#34;部署-codeigniter-并配置-routesphp&#34;&gt;
  部署 CodeIgniter 并配置 routes.php
  &lt;a class=&#34;heading-link&#34; href=&#34;#%e9%83%a8%e7%bd%b2-codeigniter-%e5%b9%b6%e9%85%8d%e7%bd%ae-routesphp&#34;&gt;
    &lt;i class=&#34;fa fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;
  &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;部署过程就不细说了，若有问题直接甩评论上来吧。&lt;/p&gt;
&lt;p&gt;仅以演示为目的，我们进入 &lt;code&gt;/application/controllers&lt;/code&gt; 目录，把 CI 自带的&lt;code&gt;Welcome.php&lt;/code&gt; 代码修改成如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;defined&lt;span style=&#34;color:#eceff4&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;BASEPATH&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;OR&lt;/span&gt; &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;exit&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;No direct script access allowed&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#8fbcbb&#34;&gt;Welcome&lt;/span&gt; &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;extends&lt;/span&gt; CI_Controller &lt;span style=&#34;color:#eceff4&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#88c0d0&#34;&gt;index&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#eceff4&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;echo&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;Hello user&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#eceff4&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;然后，复制 &lt;code&gt;Welcome.php&lt;/code&gt;，并命名为 &lt;code&gt;Welcome_admin.php&lt;/code&gt;，并对文件内容也进行相应的修改：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;defined&lt;span style=&#34;color:#eceff4&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;BASEPATH&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;OR&lt;/span&gt; &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;exit&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;No direct script access allowed&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#8fbcbb&#34;&gt;Welcome_admin&lt;/span&gt; &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;extends&lt;/span&gt; CI_Controller &lt;span style=&#34;color:#eceff4&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#88c0d0&#34;&gt;index&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#eceff4&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;echo&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;Hello admin&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#eceff4&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;接着，让魔法在 &lt;code&gt;routes.php&lt;/code&gt; 文件里发生吧。打开 &lt;code&gt;/application/config&lt;/code&gt; 目录中的&lt;code&gt;routes.php&lt;/code&gt;。在已有代码的后面插入下列代码：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#eceff4&#34;&gt;(&lt;/span&gt;$_SERVER&lt;span style=&#34;color:#eceff4&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;HTTP_HOST&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#81a1c1&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;user.example.com&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  $route&lt;span style=&#34;color:#eceff4&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;(:any)&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#81a1c1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;welcome&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;elseif&lt;/span&gt; &lt;span style=&#34;color:#eceff4&#34;&gt;(&lt;/span&gt;$_SERVER&lt;span style=&#34;color:#eceff4&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;HTTP_HOST&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#81a1c1&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;admin.example.com&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  $route&lt;span style=&#34;color:#eceff4&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;(:any)&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#81a1c1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;welcome_admin&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;现在，分别访问 &lt;code&gt;http://user.example.com&lt;/code&gt; 和 &lt;code&gt;http://admin.example.com&lt;/code&gt;，你将看到两个不同的控制器所生成的页面。即达到了多域名访问不同控制器的目的。&lt;/p&gt;
&lt;p&gt;再配合 HMVC 扩展，我们可以将控制器分成一个个独立的模块，与 CI 的基础代码解耦，让开发时条理更加清晰。&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>CodeIgniter 的多版本 RESTful 接口</title>
      <link>http://localhost:1313/posts/build-versioned-restful-service-with-codeigniter.html</link>
      <pubDate>Sun, 17 Jan 2016 19:55:34 +0000</pubDate>
      
      <guid>http://localhost:1313/posts/build-versioned-restful-service-with-codeigniter.html</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://www.codeigniter.com/&#34;&gt;CodeIgniter&lt;/a&gt; 是基于 PHP 的框架程序，采用 MVC 式设计。配合 &lt;a href=&#34;https://github.com/chriskacerguis/codeigniter-restserver&#34;&gt;codeigniter-restserver&lt;/a&gt; 能够快速搭建 RESTful 服务。&lt;/p&gt;
&lt;p&gt;本文介绍的是在 Nginx 服务器上搭建多版本 RESTful 服务的例子。即创建 &lt;code&gt;http://api.example.com/v1/user&lt;/code&gt; 这种在 URL 中包含版本号的接口。&lt;/p&gt;
&lt;h2 id=&#34;nginx-配置&#34;&gt;
  Nginx 配置
  &lt;a class=&#34;heading-link&#34; href=&#34;#nginx-%e9%85%8d%e7%bd%ae&#34;&gt;
    &lt;i class=&#34;fa fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;
  &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;首先配置 CodeIgniter 的运行环境，在 Nginx 配置中添加如下代码：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-nginx&#34; data-lang=&#34;nginx&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;server&lt;/span&gt; &lt;span style=&#34;color:#eceff4&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#616e87;font-style:italic&#34;&gt;# api server definition
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#616e87;font-style:italic&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;server_name&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;api.example.com&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;root&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;/your/codeigniter/folder&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;index&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;index.php&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;index.html&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;index.htm&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;location&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color:#eceff4&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;try_files&lt;/span&gt; $uri $uri/ &lt;span style=&#34;color:#a3be8c&#34;&gt;/index.php?&lt;/span&gt;$query_string&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#eceff4&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;location&lt;/span&gt; &lt;span style=&#34;color:#eceff4&#34;&gt;~&lt;/span&gt; &lt;span style=&#34;color:#ebcb8b&#34;&gt;\.php($|/)&lt;/span&gt; &lt;span style=&#34;color:#eceff4&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;fastcgi_pass&lt;/span&gt; 127.0.0.1&lt;span style=&#34;color:#eceff4&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#b48ead&#34;&gt;9000&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;fastcgi_index&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;index.php&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;fastcgi_split_path_info&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;^(.+\.php)(.*)&lt;/span&gt;$&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;fastcgi_param&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;PATH_INFO&lt;/span&gt; $fastcgi_path_info&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;fastcgi_param&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;SCRIPT_FILENAME&lt;/span&gt; $document_root$fastcgi_script_name&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;include&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;fastcgi_params&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#eceff4&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;location&lt;/span&gt; &lt;span style=&#34;color:#eceff4&#34;&gt;~&lt;/span&gt; &lt;span style=&#34;color:#ebcb8b&#34;&gt;/\.ht&lt;/span&gt; &lt;span style=&#34;color:#eceff4&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;deny&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;all&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#eceff4&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;其中使用 &lt;code&gt;try_files&lt;/code&gt; 指令来重写 URL，去掉 CI 默认 URL 中的 &lt;code&gt;/index.php&lt;/code&gt; 部分。&lt;/p&gt;
&lt;p&gt;部署好 CI 的代码之后，访问域名，就能看到 Welcome 画面了。&lt;/p&gt;
&lt;h2 id=&#34;配置-codeigniter&#34;&gt;
  配置 CodeIgniter
  &lt;a class=&#34;heading-link&#34; href=&#34;#%e9%85%8d%e7%bd%ae-codeigniter&#34;&gt;
    &lt;i class=&#34;fa fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;
  &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;下面对 CI 进行以下简单的设置，配合去除 &lt;code&gt;/index.php&lt;/code&gt; 美化 URL 的工作。&lt;/p&gt;
&lt;p&gt;找到 &lt;code&gt;/application/config/config.php&lt;/code&gt; 文件，将 38 行改成如下内容（行号可能因为具体的 CI 版本而不同，我的版本是 3.0.4）：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$config&lt;span style=&#34;color:#eceff4&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;index_page&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#81a1c1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;然后找到同文件中的 55 行，确保内容与下面的相同：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$config&lt;span style=&#34;color:#eceff4&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;uri_protocol&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;]&lt;/span&gt;	&lt;span style=&#34;color:#81a1c1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;REQUEST_URI&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;引入-codeigniter-rest-server&#34;&gt;
  引入 CodeIgniter Rest Server
  &lt;a class=&#34;heading-link&#34; href=&#34;#%e5%bc%95%e5%85%a5-codeigniter-rest-server&#34;&gt;
    &lt;i class=&#34;fa fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;
  &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;下载 &lt;a href=&#34;https://github.com/chriskacerguis/codeigniter-restserver&#34;&gt;codeigniter-restserver&lt;/a&gt; 后，将压缩包里的&lt;code&gt;application/libraries/Format.php&lt;/code&gt;、&lt;code&gt;application/libraries/REST_Controller.php&lt;/code&gt;和 &lt;code&gt;application/config/rest.php&lt;/code&gt; 三个文件分别放进你自己的 CI 部署中的对应文件夹。&lt;/p&gt;
&lt;p&gt;更多 CodeIgniter Rest Server 的使用说明请参考其 readme.md 文件。&lt;/p&gt;
&lt;h2 id=&#34;创建-api-方法和转发规则&#34;&gt;
  创建 API 方法和转发规则
  &lt;a class=&#34;heading-link&#34; href=&#34;#%e5%88%9b%e5%bb%ba-api-%e6%96%b9%e6%b3%95%e5%92%8c%e8%bd%ac%e5%8f%91%e8%a7%84%e5%88%99&#34;&gt;
    &lt;i class=&#34;fa fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;
  &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;我们将通过在 &lt;code&gt;controllers&lt;/code&gt; 目录下创建子目录的方式来实现多版本 API。在本文撰写之前，曾有 &lt;a href=&#34;https://github.com/chriskacerguis/codeigniter-restserver/issues/272#issuecomment-33138531&#34;&gt;issue&lt;/a&gt; 表示 CI 只支持在 &lt;code&gt;controllers&lt;/code&gt; 中创建一层子目录，无法使用多层。而本人实测后，目前版本的 CI 已经支持多层子目录了。下面是创建方法。&lt;/p&gt;
&lt;p&gt;在 &lt;code&gt;controllers&lt;/code&gt; 目录下创建文件夹，命名为 &lt;code&gt;api&lt;/code&gt;。然后在 &lt;code&gt;/controllers/api&lt;/code&gt; 下再创建一个文件夹 &lt;code&gt;v1&lt;/code&gt;。在里面创建一个 &lt;code&gt;Example.php&lt;/code&gt; 文件，输入如下代码：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;defined&lt;span style=&#34;color:#eceff4&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;BASEPATH&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;OR&lt;/span&gt; &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;exit&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;No direct script access allowed&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;require_once&lt;/span&gt; APPPATH &lt;span style=&#34;color:#81a1c1&#34;&gt;.&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;/libraries/REST_Controller.php&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#8fbcbb&#34;&gt;Example&lt;/span&gt; &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;extends&lt;/span&gt; REST_Controller
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#88c0d0&#34;&gt;new_get&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#eceff4&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        $this&lt;span style=&#34;color:#81a1c1&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#8fbcbb&#34;&gt;response&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;([&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;error&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#81a1c1&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#b48ead&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;data&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#81a1c1&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;user data from v1&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#eceff4&#34;&gt;],&lt;/span&gt; REST_Controller&lt;span style=&#34;color:#81a1c1&#34;&gt;::&lt;/span&gt;&lt;span style=&#34;color:#8fbcbb&#34;&gt;HTTP_OK&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#eceff4&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;然后，再回到 &lt;code&gt;/controllers/api&lt;/code&gt; 目录，创建文件夹 &lt;code&gt;v2&lt;/code&gt;，在其中创建 &lt;code&gt;Example.php&lt;/code&gt;文件，输入如下代码：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;defined&lt;span style=&#34;color:#eceff4&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;BASEPATH&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;OR&lt;/span&gt; &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;exit&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;No direct script access allowed&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;require_once&lt;/span&gt; APPPATH &lt;span style=&#34;color:#81a1c1&#34;&gt;.&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;/libraries/REST_Controller.php&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#8fbcbb&#34;&gt;Example&lt;/span&gt; &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;extends&lt;/span&gt; REST_Controller
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#81a1c1;font-weight:bold&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#88c0d0&#34;&gt;new_get&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#eceff4&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        $this&lt;span style=&#34;color:#81a1c1&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#8fbcbb&#34;&gt;response&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;([&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;error&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#81a1c1&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#b48ead&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;data&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#81a1c1&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;user data from v2&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#eceff4&#34;&gt;],&lt;/span&gt; REST_Controller&lt;span style=&#34;color:#81a1c1&#34;&gt;::&lt;/span&gt;&lt;span style=&#34;color:#8fbcbb&#34;&gt;HTTP_OK&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#eceff4&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;其实两个 &lt;code&gt;Example.php&lt;/code&gt; 文件的内容大部分相同，唯一的区别是返回的字符串标识出它们来自哪个版本的 API，方便我们测试。&lt;/p&gt;
&lt;p&gt;接下来，就是定义 &lt;code&gt;routes.php&lt;/code&gt; 中的规则了。打开 &lt;code&gt;/config/routes.php&lt;/code&gt; 文件，在最下边添加如下代码：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$route&lt;span style=&#34;color:#eceff4&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;v(:num)/(:any)/(:any)&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#81a1c1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#39;api/v$1/$2/$3&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;这就是版本切换魔法的所在，这一行代码表示把任何形如 &lt;code&gt;http://api.example.com/v1/any_request&lt;/code&gt; 的请求重定向到&lt;code&gt;/controllers/api/v1/any_request&lt;/code&gt; 这个类中。其中，&lt;code&gt;v1&lt;/code&gt; 的数字部分可以替换成任何数字，只要存在该数字对应的 API 版本即可访问。详细点说，等号左边的 &lt;code&gt;(:num)&lt;/code&gt; 和两个 &lt;code&gt;(:any)&lt;/code&gt; 分别对应右边的 $1、$2 和 $3，代表 URL 中的可变部分：$1 为 API 版本号，$2 为类名，$3 为方法名。也就是说，右边的层级实际上反映出文件系统中的目录和类下方法的层级。&lt;/p&gt;
&lt;p&gt;现在，可以直接在浏览器中访问 &lt;code&gt;http://api.example.com/v1/example/new&lt;/code&gt;，你会看到一串 json 内容，&lt;code&gt;data&lt;/code&gt; 部分为「user data from v1」。接着，将 URL 中的 v1 换成 v2，&lt;code&gt;data&lt;/code&gt; 部分就会显示出「user data from v2」。&lt;/p&gt;
&lt;p&gt;这样，对 API 用户而言，切换版本号不会影响到已有的大部分代码。当然，前提是他们没有把版本号写死在自己的代码里。&lt;/p&gt;
&lt;h2 id=&#34;总结&#34;&gt;
  总结
  &lt;a class=&#34;heading-link&#34; href=&#34;#%e6%80%bb%e7%bb%93&#34;&gt;
    &lt;i class=&#34;fa fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;
  &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;用 CodeIgniter 作为 API 后端的框架是个非常好的选择，官方文档和社区贡献内容都较丰富。除此之外，你也可以考虑使用 Slim 或者 Phalcon 等更加轻便的框架。&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Laravel 5 Homestead 日常工作流程</title>
      <link>http://localhost:1313/posts/laravel-homestead-daily-workflow.html</link>
      <pubDate>Mon, 23 Nov 2015 10:51:15 +0000</pubDate>
      
      <guid>http://localhost:1313/posts/laravel-homestead-daily-workflow.html</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;本文是教程的第三步，并假设你已安装好全部所需软件。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;本章将探索两种 composer 工具：homestead 和 laravel。接下来讲解一种典型的日常工作流程，通过 6 个步骤，来建立一个新的 Laravel 5.1 工程。&lt;/p&gt;
&lt;h2 id=&#34;目录&#34;&gt;
  目录
  &lt;a class=&#34;heading-link&#34; href=&#34;#%e7%9b%ae%e5%bd%95&#34;&gt;
    &lt;i class=&#34;fa fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;
  &lt;/a&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#56-homestead-tools&#34;&gt;Homestead 工具&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#56-homestead-overview&#34;&gt;常用 Homestead 命令概览&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#56-homestead-yaml&#34;&gt;了解 Homestead.yaml&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#56-homestead-software&#34;&gt;向 Homestead 虚拟机添加软件&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#56-daily-workflow&#34;&gt;日常工作流程&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#56-6-steps&#34;&gt;六个步骤开启一个全新 Laravel 5.1 工程&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#56-step-1&#34;&gt;第一步 – 创建应用骨架&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;56-step-2&#34;&gt;第二步 – 配置 Web 服务器&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;56-step-3&#34;&gt;第三步 – 添加主机记录到 Hosts 文件&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#56-step-4&#34;&gt;第四步 – NPM 本地安装&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#56-step-5&#34;&gt;第五步 – 创建应用的数据库&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#56-step-6&#34;&gt;第六步 – 在浏览器中测试&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#56-homestead-tips&#34;&gt;其他 Homestead 小贴士&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#56-recap&#34;&gt;本文回顾&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;homestead-工具&#34;&gt;
  Homestead 工具
  &lt;a class=&#34;heading-link&#34; href=&#34;#homestead-%e5%b7%a5%e5%85%b7&#34;&gt;
    &lt;i class=&#34;fa fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;
  &lt;/a&gt;
&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;什么是控制台&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;每当你需要在控制台里进行一些操作时，你需要搞清楚是哪种控制台。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Homestead 控制台&lt;/strong&gt;是指通过 SSH 连接到 Homestead 虚拟机。在 Windows 系统中，可以是通过 PuTTY 建立的连接（详情请阅读在 Windows 系统建立虚拟机的章节）。在其他操作系统中，在终端执行&lt;code&gt;homestead ssh&lt;/code&gt; 命令就可以进行连接了。在本文中，凡是跟在 &lt;code&gt;$&lt;/code&gt; 后边的命令，都是在 Homestead 终端执行的。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;OS 控制台&lt;/strong&gt;是指 Windows 的命令行提示符或者其他你正在使用的终端软件。（本文中 &lt;code&gt;%&lt;/code&gt; 符号后边的命令都是在 OS 控制台中执行的）&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;在宿主机的控制台中，我们输入 homestead 命令（不带任何参数），就可以轻松查看所有可用的 homestead 参数和命令。&lt;/p&gt;
&lt;h2 id=&#34;homestead-命令&#34;&gt;
  Homestead 命令
  &lt;a class=&#34;heading-link&#34; href=&#34;#homestead-%e5%91%bd%e4%bb%a4&#34;&gt;
    &lt;i class=&#34;fa fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;
  &lt;/a&gt;
&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;% homestead
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Laravel Homestead version 2.0.9
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Usage:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[options] command [arguments]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Options:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;--help           -h Display this help message.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;--quiet          -q Do not output any message.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;--verbose        -v|vv|vvv Increase the verbosity of messages: 1 for normal output, 2 for more verbose output and 3 for debug.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;--version        -V Display this application version.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;--ansi           Force ANSI output.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;--no-ansi        Disable ANSI output.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;--no-interaction -n Do not ask any interactive question.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Available commands:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;destroy   Destroy the Homestead machine
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;edit      Edit the Homestead.yaml file
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;halt      Halt the Homestead machine
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;help      Displays help for a command
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;init      Create a stub Homestead.yaml file
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;list      Lists commands
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;provision Re-provisions the Homestead machine
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;resume    Resume the suspended Homestead machine
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;run       Run commands through the Homestead machine via SSH
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ssh       Login to the Homestead machine via SSH
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;status    Get the status of the Homestead machine
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;suspend   Suspend the Homestead machine
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;up        Start the Homestead machine
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;update    Update the Homestead machine image
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;我们每天接触最多的一个命令是 &lt;code&gt;homestead up&lt;/code&gt;，用来启动 Homestead 虚拟机。&lt;/p&gt;
&lt;h2 id=&#34;常用-homestead-命令概览&#34;&gt;
  常用 Homestead 命令概览
  &lt;a class=&#34;heading-link&#34; href=&#34;#%e5%b8%b8%e7%94%a8-homestead-%e5%91%bd%e4%bb%a4%e6%a6%82%e8%a7%88&#34;&gt;
    &lt;i class=&#34;fa fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;
  &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;这里是一系列常用的 Homestead 命令。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;homestead up&lt;/code&gt; 启动 Homestead 虚拟机，或者说「点亮」虚拟机的电源。如果你使用了 provision 选项（&lt;code&gt;homestead up --provision&lt;/code&gt;），则 provision 配置将对所有新增加的站点都生效。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;homestead halt&lt;/code&gt; 停止 Homestead 虚拟机，或者说「关闭」虚拟机的电源。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;homestead suspend&lt;/code&gt; 暂停 Homestead 虚拟机，可以理解为休眠。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;homestead resume&lt;/code&gt; 将暂停的 Homestead 虚拟机恢复运行。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;homestead edit&lt;/code&gt; 编辑 Homestead.yaml 文件。这个命令将使用当前与 YAML 文件格式关联的编辑器软件。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;homestead status&lt;/code&gt; 查看 Homestead 虚拟机的当前状态&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;了解-homesteadyaml&#34;&gt;
  了解 Homestead.yaml
  &lt;a class=&#34;heading-link&#34; href=&#34;#%e4%ba%86%e8%a7%a3-homesteadyaml&#34;&gt;
    &lt;i class=&#34;fa fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;
  &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Laravel Homestead 的配置都在 Homestead.yaml 文件中。该文件位于你的宿主系统 home 目录中的 &lt;code&gt;.homestead&lt;/code&gt; 目录下。&lt;/p&gt;
&lt;p&gt;查看该文件的内容，大致如下。&lt;/p&gt;
&lt;h4 id=&#34;homesteadyaml-的内容&#34;&gt;
  Homestead.yaml 的内容
  &lt;a class=&#34;heading-link&#34; href=&#34;#homesteadyaml-%e7%9a%84%e5%86%85%e5%ae%b9&#34;&gt;
    &lt;i class=&#34;fa fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;
  &lt;/a&gt;
&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8fbcbb&#34;&gt;---&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#81a1c1&#34;&gt;ip&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#a3be8c&#34;&gt;&amp;#34;192.168.10.10&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#81a1c1&#34;&gt;memory&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#b48ead&#34;&gt;2048&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#81a1c1&#34;&gt;cpus&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#b48ead&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#81a1c1&#34;&gt;authorize&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;:&lt;/span&gt; ~/.ssh/id_rsa.pub
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#81a1c1&#34;&gt;keys&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;- ~/.ssh/id_rsa
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#81a1c1&#34;&gt;folders&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;- &lt;span style=&#34;color:#81a1c1&#34;&gt;map&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;:&lt;/span&gt; ~/Code
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#81a1c1&#34;&gt;to&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;:&lt;/span&gt; /home/vagrant/Code
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#81a1c1&#34;&gt;sites&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;- &lt;span style=&#34;color:#81a1c1&#34;&gt;map&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;:&lt;/span&gt; homestead.app
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#81a1c1&#34;&gt;to&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;:&lt;/span&gt; /home/vagrant/Code/Laravel/public
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#81a1c1&#34;&gt;databases&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;- homestead
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#81a1c1&#34;&gt;variables&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;- &lt;span style=&#34;color:#81a1c1&#34;&gt;key&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;:&lt;/span&gt; APP_ENV
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#81a1c1&#34;&gt;value&lt;/span&gt;&lt;span style=&#34;color:#eceff4&#34;&gt;:&lt;/span&gt; local
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;下面逐一解释各个配置部分：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ip&lt;/code&gt; 访问虚拟机所用的内网 IP。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;memory&lt;/code&gt; 虚拟机的可用内存。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;cpus&lt;/code&gt; 虚拟机的可用 CPU 数目。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;authorize&lt;/code&gt; 此项应该指向你的 SSH 公钥。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;keys&lt;/code&gt; 你的 SSH 私钥。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;folders&lt;/code&gt; 共享文件夹，即宿主机中的文件夹和对应在虚拟机中的文件夹。在 Windows 系统中，&lt;code&gt;~/Code&lt;/code&gt; 目录大致上等同于 &lt;code&gt;C:\Users\YOU\Code&lt;/code&gt; 文件夹。在 OS X 中为&lt;code&gt;/Users/YOU/Code&lt;/code&gt;。在 Linux 中通常是 &lt;code&gt;/home/YOU/Code&lt;/code&gt;。当你在宿主机的这个文件夹里进行文件操作时，虚拟机中的对应目录中也会立即发生改变。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;sites&lt;/code&gt; 站点列表（各个域名指向的路径），每当 Homestead 虚拟机启动时将生效。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;databases&lt;/code&gt; Homestead 应该能自动创建的数据库列表。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;variables&lt;/code&gt; 将在 Homestead 环境中生效的变量。&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;配置小技巧&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;我一般只对一处进行修改，将数据库下边的 homestead 改名为 xhomestead。这样做的目的在于，如果我忘记为新应用创建数据库，就会报错。否则，会使用默认的 homestead 数据库，我却无法察觉。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;那么现在，除了 &lt;strong&gt;database&lt;/strong&gt; 之外，我们不修改任何配置。&lt;/p&gt;
&lt;h4 id=&#34;homestead-虚拟机详细配置&#34;&gt;
  Homestead 虚拟机详细配置
  &lt;a class=&#34;heading-link&#34; href=&#34;#homestead-%e8%99%9a%e6%8b%9f%e6%9c%ba%e8%af%a6%e7%bb%86%e9%85%8d%e7%bd%ae&#34;&gt;
    &lt;i class=&#34;fa fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;
  &lt;/a&gt;
&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;字段&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;值&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Hostname&lt;/td&gt;
&lt;td&gt;homestead&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IP Address&lt;/td&gt;
&lt;td&gt;192.168.10.10&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Username&lt;/td&gt;
&lt;td&gt;vagrant&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SU Password&lt;/td&gt;
&lt;td&gt;vagrant&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Database Host&lt;/td&gt;
&lt;td&gt;127.0.0.1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Database Port&lt;/td&gt;
&lt;td&gt;33060&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Database Username&lt;/td&gt;
&lt;td&gt;homestead&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Database Password&lt;/td&gt;
&lt;td&gt;secret&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;向-homestead-虚拟机添加软件&#34;&gt;
  向 Homestead 虚拟机添加软件
  &lt;a class=&#34;heading-link&#34; href=&#34;#%e5%90%91-homestead-%e8%99%9a%e6%8b%9f%e6%9c%ba%e6%b7%bb%e5%8a%a0%e8%bd%af%e4%bb%b6&#34;&gt;
    &lt;i class=&#34;fa fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;
  &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;若你需要在 Homestead 虚拟机中安装新的软件，可以使用 Ubuntu 的 &lt;code&gt;apt-get&lt;/code&gt; 命令。&lt;/p&gt;
&lt;p&gt;这是非常简便的两个步骤：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;升级 Ubuntu&lt;/li&gt;
&lt;li&gt;用 apt-get 安装&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;下边举例说明，当我们需要 unzip 这个软件时，应该怎样进行安装。&lt;/p&gt;
&lt;h4 id=&#34;升级-ubuntu&#34;&gt;
  升级 Ubuntu
  &lt;a class=&#34;heading-link&#34; href=&#34;#%e5%8d%87%e7%ba%a7-ubuntu&#34;&gt;
    &lt;i class=&#34;fa fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;
  &lt;/a&gt;
&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#616e87;font-style:italic&#34;&gt;# 将 Ubuntu 软件升级到最新&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vagrant@homestead:~$ sudo apt-get update
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vagrant@homestead:~$ sudo apt-get upgrade
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;选择「Y」来继续安装。如果安装过程中出现什么提示，尽量选择已有的或默认配置。&lt;/p&gt;
&lt;p&gt;升级完 Homestead 虚拟机里的 Ubuntu 系统之后，就可以安装 unzip 了。&lt;/p&gt;
&lt;h4 id=&#34;通过-apt-get-安装-unzip&#34;&gt;
  通过 apt-get 安装 unzip
  &lt;a class=&#34;heading-link&#34; href=&#34;#%e9%80%9a%e8%bf%87-apt-get-%e5%ae%89%e8%a3%85-unzip&#34;&gt;
    &lt;i class=&#34;fa fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;
  &lt;/a&gt;
&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#616e87;font-style:italic&#34;&gt;# 在 Homestead 虚拟机中安装 unzip&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vagrant@homestead:~$ sudo apt-get install unzip
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;日常工作流程&#34;&gt;
  日常工作流程
  &lt;a class=&#34;heading-link&#34; href=&#34;#%e6%97%a5%e5%b8%b8%e5%b7%a5%e4%bd%9c%e6%b5%81%e7%a8%8b&#34;&gt;
    &lt;i class=&#34;fa fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;
  &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;通常，使用 homestead 处理日常工作的流程主要分成三个步骤：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;第一步：&lt;/strong&gt;&lt;code&gt;homestead up&lt;/code&gt; 启动 Homestead 虚拟机开始一天的工作。
&lt;strong&gt;第二步：&lt;/strong&gt;&lt;code&gt;homestead ssh&lt;/code&gt;、&lt;code&gt;PuTTY&lt;/code&gt; 通过 SSH 连接到 Homestead 虚拟机，直接访问文件，并执行 artisan 命令。
**第三步：**编写优美的代码。在宿主系统中，打开你最爱的编辑器，开始写代码。
&lt;strong&gt;可选的第四步：&lt;/strong&gt;&lt;code&gt;homestead halt&lt;/code&gt; 一天的工作结束后，你可以选择关闭 Homestead 虚拟机的电源。&lt;/p&gt;
&lt;h2 id=&#34;六个步骤开启一个全新-laravel-51-工程&#34;&gt;
  六个步骤开启一个全新 Laravel 5.1 工程
  &lt;a class=&#34;heading-link&#34; href=&#34;#%e5%85%ad%e4%b8%aa%e6%ad%a5%e9%aa%a4%e5%bc%80%e5%90%af%e4%b8%80%e4%b8%aa%e5%85%a8%e6%96%b0-laravel-51-%e5%b7%a5%e7%a8%8b&#34;&gt;
    &lt;i class=&#34;fa fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;
  &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;每次建立新的 Laravel 5.1 应用时，你都可以跟随下边的六大步骤来进行。&lt;/p&gt;
&lt;p&gt;比方说，我们要创建一个名叫 &lt;code&gt;test.app&lt;/code&gt; 的工程，项目文件夹的名字就叫 &lt;code&gt;test&lt;/code&gt;。&lt;/p&gt;
&lt;h4 id=&#34;第一步-创建应用骨架&#34;&gt;
  第一步 创建应用骨架
  &lt;a class=&#34;heading-link&#34; href=&#34;#%e7%ac%ac%e4%b8%80%e6%ad%a5-%e5%88%9b%e5%bb%ba%e5%ba%94%e7%94%a8%e9%aa%a8%e6%9e%b6&#34;&gt;
    &lt;i class=&#34;fa fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;
  &lt;/a&gt;
&lt;/h4&gt;
&lt;p&gt;通过 Laravel Installer（前置章节中安装好的 &lt;code&gt;laravel&lt;/code&gt; 命令），可以迅速创建一个工程骨架。&lt;/p&gt;
&lt;p&gt;创建一个新的应用骨架&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ laravel new &lt;span style=&#34;color:#81a1c1&#34;&gt;test&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Crafting application...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Generating optimized class loader
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Compiling common classes
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Application key &lt;span style=&#34;color:#81a1c1&#34;&gt;[&lt;/span&gt;rzUhyDksVxzTXFjzFYiOWToqpunI2m6X&lt;span style=&#34;color:#81a1c1&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#81a1c1&#34;&gt;set&lt;/span&gt; successfully.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Application ready! Build something amazing.
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;第二步-配置-web-服务器&#34;&gt;
  第二步 配置 Web 服务器
  &lt;a class=&#34;heading-link&#34; href=&#34;#%e7%ac%ac%e4%ba%8c%e6%ad%a5-%e9%85%8d%e7%bd%ae-web-%e6%9c%8d%e5%8a%a1%e5%99%a8&#34;&gt;
    &lt;i class=&#34;fa fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;
  &lt;/a&gt;
&lt;/h4&gt;
&lt;p&gt;安装好应用骨架后，就可以在 homestead 环境中启动 Nginx 服务器，来为应用的&lt;code&gt;public&lt;/code&gt; 目录建立网页服务了。&lt;/p&gt;
&lt;p&gt;Homestead 环境中的 &lt;code&gt;serve&lt;/code&gt; 命令可以轻松完成这一任务。&lt;/p&gt;
&lt;p&gt;在 Homestead 中启动一个新的虚拟主机&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ serve test.app ~/Code/test/public
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;dos2unix: converting file /vagrant/scripts/serve.sh to Unix format ...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;* Restarting nginx nginx                                    &lt;span style=&#34;color:#81a1c1&#34;&gt;[&lt;/span&gt; OK &lt;span style=&#34;color:#81a1c1&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;php5-fpm stop/waiting
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;php5-fpm start/running, process &lt;span style=&#34;color:#b48ead&#34;&gt;2169&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;这条命令会在 &lt;code&gt;/etc/nginx/sites-available&lt;/code&gt; 目录下，为 &lt;strong&gt;test.app&lt;/strong&gt; 生成一个新的配置文件，并在 &lt;code&gt;/etc/nginx/sites-enabled&lt;/code&gt; 目录下生成一个指向该配置文件的软连接。&lt;/p&gt;
&lt;p&gt;即使虚拟机重启，该配置也会依然存在。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;为什么不直接编辑 Homestead.yaml&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;你问得对。另外一种建立 test.app 服务器的方式是 &lt;code&gt;homestead edit&lt;/code&gt; 命令，并在 &lt;em&gt;sites:&lt;/em&gt; 下边输入新的站点信息。但 serve 命令更简单，并且无需重新配置并启动 Homestead 虚拟机。&lt;/p&gt;
&lt;p&gt;然而，有时你可能需要经常对某个应用进行配置，你完全可以去编辑 Homestead.yaml 文件。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;第三步添加主机记录到-hosts-文件&#34;&gt;
  第三步 添加主机记录到 Hosts 文件
  &lt;a class=&#34;heading-link&#34; href=&#34;#%e7%ac%ac%e4%b8%89%e6%ad%a5%e6%b7%bb%e5%8a%a0%e4%b8%bb%e6%9c%ba%e8%ae%b0%e5%bd%95%e5%88%b0-hosts-%e6%96%87%e4%bb%b6&#34;&gt;
    &lt;i class=&#34;fa fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;
  &lt;/a&gt;
&lt;/h4&gt;
&lt;p&gt;截至目前，test.app 的域名还无法解析（没有任何 DNS 记录），必须向宿主系统的 hosts 文件添加一条记录。编辑 Linux 或 OS X 中的 &lt;code&gt;/etc/hosts&lt;/code&gt; 文件。Windows 系统中，该文件位于 &lt;code&gt;C:\Windows\System32\drivers\etc\hosts&lt;/code&gt;。将 &lt;code&gt;test.app&lt;/code&gt; 这个域名指向 &lt;code&gt;Homestead.yaml&lt;/code&gt; 文件中指定的 IP 地址即可。&lt;/p&gt;
&lt;p&gt;例如将下一行加入文件中。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Test.app 的 Host 记录&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;192.168.10.10  test.app
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Windows 系统需要管理员权限来编辑 hosts 文件&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;在 Windows 中，你必须以管理员身份运行编辑器软件（例如写字板或 Sublime Text 等）。在 Linux 或 OS X 中则可以使用 &lt;code&gt;sudo&lt;/code&gt; 命令。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;在 Linux 或 OS X 中编辑 hosts 文件&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo nano /etc/hosts
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;// or
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo vi /etc/hosts
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;第四步npm-本地安装&#34;&gt;
  第四步 NPM 本地安装
  &lt;a class=&#34;heading-link&#34; href=&#34;#%e7%ac%ac%e5%9b%9b%e6%ad%a5npm-%e6%9c%ac%e5%9c%b0%e5%ae%89%e8%a3%85&#34;&gt;
    &lt;i class=&#34;fa fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;
  &lt;/a&gt;
&lt;/h4&gt;
&lt;p&gt;为了稍后可以使用 &lt;code&gt;gulp&lt;/code&gt;，我们需要将所需的 npm 模块都在本地安装好。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;如果你用不到 gulp，那么就跳过这一步吧。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;在宿主系统的控制台中进入工程所在的目录，并执行以下命令。&lt;/p&gt;
&lt;p&gt;NPM 本地安装&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ cd Code/test
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;~/Code/test% npm install
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;npm WARN package.json @ No repository field.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;v8flags@1.0.5 install /Users/chuck/Code/test/node_modules/gulp/\
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;node_modules/v8flags
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;gt; node fetch.js
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;flags for v8 3.14.5.9 cached.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[snip]
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;这样，gulp 所需的所有依赖都会安装到工程目录中的 &lt;code&gt;node_modules&lt;/code&gt; 文件夹了。&lt;/p&gt;
&lt;h4 id=&#34;第五步创建应用的数据库&#34;&gt;
  第五步 创建应用的数据库
  &lt;a class=&#34;heading-link&#34; href=&#34;#%e7%ac%ac%e4%ba%94%e6%ad%a5%e5%88%9b%e5%bb%ba%e5%ba%94%e7%94%a8%e7%9a%84%e6%95%b0%e6%8d%ae%e5%ba%93&#34;&gt;
    &lt;i class=&#34;fa fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;
  &lt;/a&gt;
&lt;/h4&gt;
&lt;p&gt;如果应用需要数据库，进入 Homestead 虚拟机的 &lt;strong&gt;mysql&lt;/strong&gt; 控制台就能轻松创建数据库了。&lt;/p&gt;
&lt;p&gt;在 Homestead 虚拟机中创建数据库&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ mysql --user&lt;span style=&#34;color:#81a1c1&#34;&gt;=&lt;/span&gt;homestead --password&lt;span style=&#34;color:#81a1c1&#34;&gt;=&lt;/span&gt;secret
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;mysql&amp;gt; create database test&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;mysql&amp;gt; exit&lt;span style=&#34;color:#eceff4&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;数据库创建好之后，你需要在工程的根目录中找到 &lt;code&gt;.env&lt;/code&gt; 文件，编辑其中的 &lt;code&gt;DB_NAME&lt;/code&gt; 字段为适合的值。&lt;/p&gt;
&lt;p&gt;修改 &lt;code&gt;.env&lt;/code&gt; 中的 &lt;code&gt;DB_NAME&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#616e87;font-style:italic&#34;&gt;// Change the following line
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#616e87;font-style:italic&#34;&gt;&lt;/span&gt;DB_DATABASE&lt;span style=&#34;color:#81a1c1&#34;&gt;=&lt;/span&gt;homestead
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#616e87;font-style:italic&#34;&gt;// To the correct value
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#616e87;font-style:italic&#34;&gt;&lt;/span&gt;DB_DATABASE&lt;span style=&#34;color:#81a1c1&#34;&gt;=&lt;/span&gt;test
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;就是这样简单。现在，你可以对数据表进行迁移和创建等操作了。之后的章节将进一步介绍这些操作。&lt;/p&gt;
&lt;h4 id=&#34;第六步在浏览器中测试&#34;&gt;
  第六步 在浏览器中测试
  &lt;a class=&#34;heading-link&#34; href=&#34;#%e7%ac%ac%e5%85%ad%e6%ad%a5%e5%9c%a8%e6%b5%8f%e8%a7%88%e5%99%a8%e4%b8%ad%e6%b5%8b%e8%af%95&#34;&gt;
    &lt;i class=&#34;fa fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;
  &lt;/a&gt;
&lt;/h4&gt;
&lt;p&gt;打开浏览器，输入 &lt;code&gt;http://test.app&lt;/code&gt;，你就能看到下面的画面了。&lt;/p&gt;
&lt;p&gt;默认的 Laravel 5.1 首页&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://leanpub.com/site_images/l5-beauty/l5-welcome-page.jpg&#34; alt=&#34;l5-welcome-page&#34;&gt;&lt;/p&gt;
&lt;p&gt;如果你看到的不是这个画面，那么之前的步骤中或许有不正确的地方。&lt;/p&gt;
&lt;h2 id=&#34;其他-homestead-小贴士&#34;&gt;
  其他 Homestead 小贴士
  &lt;a class=&#34;heading-link&#34; href=&#34;#%e5%85%b6%e4%bb%96-homestead-%e5%b0%8f%e8%b4%b4%e5%a3%ab&#34;&gt;
    &lt;i class=&#34;fa fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;
  &lt;/a&gt;
&lt;/h2&gt;
&lt;h4 id=&#34;请在宿主系统中编写代码&#34;&gt;
  请在宿主系统中编写代码
  &lt;a class=&#34;heading-link&#34; href=&#34;#%e8%af%b7%e5%9c%a8%e5%ae%bf%e4%b8%bb%e7%b3%bb%e7%bb%9f%e4%b8%ad%e7%bc%96%e5%86%99%e4%bb%a3%e7%a0%81&#34;&gt;
    &lt;i class=&#34;fa fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;
  &lt;/a&gt;
&lt;/h4&gt;
&lt;p&gt;之前的章节我们提到了这一点，这里再强调一次。请把代码编辑工作都放在宿主系统中进行。共享文件夹使用起来非常便捷，你在宿主系统的工程文件夹中进行的任何更改都会立即呈现在 Homestead 虚拟机中。&lt;/p&gt;
&lt;h4 id=&#34;使用-homesteadaliases-文件&#34;&gt;
  使用 .homestead/aliases 文件
  &lt;a class=&#34;heading-link&#34; href=&#34;#%e4%bd%bf%e7%94%a8-homesteadaliases-%e6%96%87%e4%bb%b6&#34;&gt;
    &lt;i class=&#34;fa fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;
  &lt;/a&gt;
&lt;/h4&gt;
&lt;p&gt;每当你需要使用 &lt;code&gt;homestead up --provision&lt;/code&gt; 或 &lt;code&gt;homestead provision&lt;/code&gt; 命令重新配置 Homestead 时，&lt;code&gt;.homestead/aliases&lt;/code&gt; 文件都会更新 Homestead 虚拟机中的各个替身。&lt;/p&gt;
&lt;p&gt;所以通过这个文件，我们可以轻松添加新的替身、函数甚至其他环境变量。&lt;/p&gt;
&lt;h4 id=&#34;保持-homestead-虚拟机在最新状态&#34;&gt;
  保持 Homestead 虚拟机在最新状态
  &lt;a class=&#34;heading-link&#34; href=&#34;#%e4%bf%9d%e6%8c%81-homestead-%e8%99%9a%e6%8b%9f%e6%9c%ba%e5%9c%a8%e6%9c%80%e6%96%b0%e7%8a%b6%e6%80%81&#34;&gt;
    &lt;i class=&#34;fa fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;
  &lt;/a&gt;
&lt;/h4&gt;
&lt;p&gt;上文提到，只需两条命令就可以将 Homestead 虚拟机里的 Ubuntu 操作系统更新到最新状态。&lt;/p&gt;
&lt;p&gt;保持 Ubuntu 最新&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ sudo apt-get update
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ sudo apt-get upgrade
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;本文回顾&#34;&gt;
  本文回顾
  &lt;a class=&#34;heading-link&#34; href=&#34;#%e6%9c%ac%e6%96%87%e5%9b%9e%e9%a1%be&#34;&gt;
    &lt;i class=&#34;fa fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;Link to heading&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;Link to heading&lt;/span&gt;
  &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;本章详细讲解了 &lt;code&gt;homestead&lt;/code&gt; 和 &lt;code&gt;laravel&lt;/code&gt; 命令，以及创建一个 Laravel 5.1 工程的简单六步。&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
